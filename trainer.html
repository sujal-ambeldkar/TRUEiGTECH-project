<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Trainer Dashboard - FitPlanHub</title>

  <style>
    :root {
      --primary: #4f46e5;
      --primary-dark: #4338ca;
        background: linear-gradient(to right, #ff512f, #dd2476);
      --card-bg: #ffffff;
      --text: #1f2937;
    }

    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: var(--bg-gradient);
      padding: 40px 20px;
      color: var(--text);
    }

    h2 {
      text-align: center;
      color: #fff;
      margin-bottom: 10px;
    }

    #logoutBtn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: #ef4444;
      color: #fff;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      cursor: pointer;
    }

    /* CREATE PLAN CARD (MAIN FOCUS) */
    .create-plan-card {
      max-width: 600px;
      margin: 30px auto 50px;
      background: var(--card-bg);
      padding: 30px;
      border-radius: 14px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.25);
    }

    .create-plan-card h3 {
      text-align: center;
      margin-bottom: 20px;
    }

    input, textarea {
      width: 100%;
      padding: 12px;
      margin-bottom: 12px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      font-size: 14px;
    }

    textarea {
      resize: vertical;
      min-height: 90px;
    }

    button[type="submit"] {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border-radius: 10px;
      background: var(--primary);
      color: #fff;
      border: none;
      cursor: pointer;
    }

    button[type="submit"]:hover {
      background: var(--primary-dark);
    }

    /* PLANS SECTION */
    .plans-section {
      max-width: 900px;
      margin: auto;
    }

    .plans-section h3 {
      color: #fff;
      margin-bottom: 15px;
      text-align: center;
    }

    .plan-card {
      background: var(--card-bg);
      padding: 18px;
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.15);
    }

    .plan-card h4 {
      margin-bottom: 6px;
      color: var(--primary);
    }

    .plan-card p {
      margin: 4px 0;
      font-size: 14px;
    }
  </style>
</head>

<body>

  <h2>Trainer Dashboard</h2>
  <button id="logoutBtn">Logout</button>

  <!-- CREATE PLAN -->
  <div class="create-plan-card">
    <h3>Create New Plan</h3>

    <form id="createPlanForm">
      <input type="text" id="title" placeholder="Plan Title" required>
      <textarea id="description" placeholder="Description" required></textarea>
      <input type="number" id="price" placeholder="Price" required>
      <input type="number" id="duration" placeholder="Duration (days)" required>
      <button type="submit">Create Plan</button>
    </form>
  </div>

  <!-- PLANS -->
  <div class="plans-section">
    <h3>Your Plans</h3>
    <div id="plansContainer"></div>
  </div>

  <!-- âŒ JS LOGIC UNCHANGED -->
 <script type="module">
import { createPlan, getTrainerPlans } from './js/api.js';

const token = localStorage.getItem('token');
const role = localStorage.getItem('role');

if (!token || role !== 'trainer') {
  window.location = 'login.html';
}

const plansContainer = document.getElementById('plansContainer');
const createForm = document.getElementById('createPlanForm');

document.getElementById('logoutBtn').addEventListener('click', () => {
  localStorage.clear();
  window.location = 'login.html';
});

// Load trainer's plans
async function loadTrainerPlans() {
  try {
    const plans = await getTrainerPlans(token);
    plansContainer.innerHTML = '';
    if (!plans.length) {
      plansContainer.innerHTML = "<p>You have no plans yet.</p>";
      return;
    }

    plans.forEach(plan => {
      const div = document.createElement('div');
      div.classList.add('plan-card');
      div.innerHTML = `
        <h4>${plan.title}</h4>
        <p>${plan.description}</p>
        <p>Duration: ${plan.duration} days</p>
        <p>Price: $${plan.price}</p>
      `;
      plansContainer.appendChild(div);
    });
  } catch (err) {
    plansContainer.innerHTML = `<p>Error: ${err.message}</p>`;
  }
}

loadTrainerPlans();

// Handle new plan creation
createForm.addEventListener('submit', async (e) => {
  e.preventDefault();

  const newPlan = {
    title: document.getElementById('title').value,
    description: document.getElementById('description').value,
    price: document.getElementById('price').value,
    duration: document.getElementById('duration').value
  };

  try {
    await createPlan(token, newPlan);
    alert('Plan created successfully!');
    createForm.reset();
    loadTrainerPlans(); // Refresh the list
  } catch (err) {
    alert('Error: ' + err.message);
  }
});
</script>


</body>
</html>
